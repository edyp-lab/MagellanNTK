<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create a new process • Magellan</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Create a new process">
<meta property="og:description" content="Magellan">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Magellan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Magellan.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CreatePipeline.html">Add a new pipeline</a>
    </li>
    <li>
      <a href="../articles/CreateProcess.html">Create a new process</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/samWieczorek/Magellan/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="CreateProcess_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Create a new process</h1>
            <h3 class="subtitle">A developer’s guidelines</h3>
                        <h4 class="author">Samuel Wieczorek</h4>
            
            <h4 class="date">novembre 03, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/samWieczorek/Magellan/blob/master/vignettes/CreateProcess.Rmd"><code>vignettes/CreateProcess.Rmd</code></a></small>
      <div class="hidden name"><code>CreateProcess.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette explains how to create a new process in the <code>Magellan</code> framework. A process is a set of data processes applied to a dataset (ie an object of class QFeatures).</p>
<p>Examples of processes are in the inst/scripts directory. This tutorial aims to explain step-by-step the construction of the process</p>
<p>As a process in <code>Magellan</code> is a shiny module, it comes with two functions ui() and server().</p>
</div>
<div id="nomenclature-of-ui-and-server-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#nomenclature-of-ui-and-server-functions" class="anchor"></a>Nomenclature of ui and server functions</h1>
<p>The name of these functions is very important because Magellan call those functions by building their name dynamically. C’est pour cela qu’il est primordial de respecter la nomenclature.</p>
<p>Chacune des deux fonctions contient quatre mots-clés séparés par ’_’:</p>
<ul>
<li>
<code>mod</code>:mot-clé fixe qui précise que la fonction est celle d’un module,</li>
<li>
<code>pipeline</code>: le nom du pipeline auquel le process appartient,</li>
<li>
<code>process</code>: le nom du process lui-même,</li>
<li>
<code>ui</code> ou <code>server</code> selon qu’il s’agit de la fonction ui ou server.</li>
</ul>
<p>Par example, la fonction <code>mod_PipelineA_Process4_server()</code> est le nom du serveur pour le process 4 du pipeline A.</p>
</div>
<div id="ui-function" class="section level1">
<h1 class="hasAnchor">
<a href="#ui-function" class="anchor"></a><code>ui()</code> function</h1>
<p>Normalement, la fonction ui() contient le code pour les interfacs graphiques. Ces interfaces sont gérées par Magellan et leur code réside dans la fonction serveur. En effet, il y a besoin qu’elles soient toutes dynamiques et de ce fait, on utilise les fonctions renderUI() et uiOutput() mais dans la partie serveur de sorte qu’on puisse les appeler dynamiquement.</p>
</div>
<div id="server-function" class="section level1">
<h1 class="hasAnchor">
<a href="#server-function" class="anchor"></a><code>server()</code> function</h1>
<div id="architecture-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#architecture-overview" class="anchor"></a>Architecture overview</h2>
<p>La fonction serveur utilise l’architecture proposée par Shiny pour écrire un module.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_PipelineA_Process3_server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>,
                                          <span class="va">dataIn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span><span class="cn">NULL</span><span class="op">}</span><span class="op">)</span>,
                                          <span class="va">steps.enabled</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span><span class="cn">NULL</span><span class="op">}</span><span class="op">)</span>,
                                          <span class="va">remoteReset</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span><span class="cn">FALSE</span><span class="op">}</span><span class="op">)</span>
<span class="op">)</span><span class="op">{</span>
  
 <span class="co"># Put here static code that is not affected by the reactive programming</span>

  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html">moduleServer</a></span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">ns</span> <span class="op">&lt;-</span> <span class="va">session</span><span class="op">$</span><span class="va">ns</span>
    <span class="co"># Put here dynamic process code</span>
    
    <span class="co"># ----- DO NOT MODIFY THIS PART  ---</span>
    <span class="co"># Definition of reactive variables and observers</span>
    <span class="co"># ----- END OF DO NOT MODIFY THIS PART ---</span>
    
    <span class="co"># Definition of the ui for each steps</span>
    <span class="co"># Write here your own code</span>
    
    
    <span class="co"># ----- DO NOT MODIFY THIS PART ---</span>
    <span class="co"># Return value of the process</span>
    <span class="co"># ----- END OF DO NOT MODIFY THIS PART ---</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The input parameters of the server function are:</p>
<ul>
<li>
<code>id</code>: The name of the server,</li>
<li>
<code>dataIn</code>: The object given as input to the process,</li>
<li>
<code>steps.enabled</code>: A vector of boolean which has the same length of the steps of the pipeline. This information is used to enable/disable the widgets. It is not a communication variable between the caller and this module, thus there is no corresponding output variable,</li>
<li>
<code>remoteReset</code>: It is a remote command to reset the module. A boolean that indicates is the pipeline has been reseted by a program of higher level Basically, it is the program which has called this module.</li>
</ul>
<p>The last three parameters are reactive because they are frequently updated during the execution of <code>Magellan</code>.</p>
<p>The function <code>mod_PipelineA_Process3_server()</code> is the high-level function which acts as a wrapper for the server function. In this part, on store the definition of non-reactive variables (like global static variables). In a process, one can find:</p>
<ul>
<li>The definition of the configuration data of the process (see below for more details),</li>
<li>The definition of the default values for the widgets</li>
</ul>
<p>The function <code><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html">moduleServer()</a></code> is the real server function for the module. It contains the following elements:</p>
<ul>
<li>Declaration of <code>rv.widgets</code> variables for widgets, This part must be modified only to write the list of widgets.</li>
<li>Declaration of <code>rv</code> reactive variables which contains the value of the input parameters. THIS PART MUST NOT BE MODIFIED</li>
<li>Declaration of the <code>dataOut</code> reactive values. THIS PART MUST NOT BE MODIFIED</li>
<li>Definition of the listener functions for the two parameters <code>steps.enabled()</code> and <code>remoteReset()</code>. THIS PART MUST NOT BE MODIFIED.</li>
<li>Code for each step (see below),</li>
<li>Return value of the process. THIS PART MUST NOT BE MODIFIED,</li>
</ul>
</div>
<div id="definition-of-the-process-config-variable" class="section level2">
<h2 class="hasAnchor">
<a href="#definition-of-the-process-config-variable" class="anchor"></a>Definition of the process (<code>config</code> variable)</h2>
<p>The <code>config</code> variable contains the information about the process. It is read by the pipeline which calls this process. The names of the 4 items must not be modified but the developper can customize their value to describe the new process</p>
<ul>
<li>
<code>name</code>: Name of the process,</li>
<li>
<code>parent</code>: Name of the pipeline it belongs to,</li>
<li>
<code>steps</code>: List of all steps of the process, Please note that the first step is always named ‘Description’.</li>
<li>
<code>mandatory</code>: A vector of boolean indicating if the steps are mandatory or not. Please note that the first step is mandatory.</li>
</ul>
</div>
</div>
<div id="writing-code-for-a-step" class="section level1">
<h1 class="hasAnchor">
<a href="#writing-code-for-a-step" class="anchor"></a>Writing code for a step</h1>
<p>The steps of a process are all built on the same schema:</p>
<ul>
<li>ObserveEvent of the widgets</li>
<li>A global <code><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI()</a></code> function that manage the ui (and further renderUI()) for the step. The <code>id</code> of this function must be equal to the name of the corresponding step.</li>
<li>Other <code><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI()</a></code> functions that define some widgets</li>
<li>
<code><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent()</a></code> for the validation button (last step). This part must not be modified</li>
<li>Code specific to the process.</li>
</ul>
<div id="important-note" class="section level2">
<h2 class="hasAnchor">
<a href="#important-note" class="anchor"></a>Important note</h2>
<p>When a step is enabled/disabled, all its widgets are also. In order to have reliability, this state is managed by a variable for each step (a given element in the <code>steps.status</code> vector, input parameter). Thus, it is mandatory that each widget have to be wrapped into an if/else statement in which the condition</p>
</div>
</div>
<div id="a-tool-to-create-a-new-process" class="section level1">
<h1 class="hasAnchor">
<a href="#a-tool-to-create-a-new-process" class="anchor"></a>A tool to create a new process</h1>
<p>A script (``) has been developed to facilitate the development of a process. It consists in a shiny app.</p>
<p>This app proposes forms to configure certain aspects of the process. At the end of the setup, the user validate its configuration and a R script is written which contains the code for the module. The part which can be modified to customize the module are showed to the user. The, he has to customize this script.</p>
<p>The app can be run in two several modes whether the level of finition of the process code:</p>
<ul>
<li>A simple mode which permits to configure a lot of aspects of the module. It guides the developer in a lot of details but is not very versatile (the user must know exactly what he want to do),</li>
<li>An expert mode which proposes the minimal configuration for the process</li>
</ul>
<div id="simple-mode" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-mode" class="anchor"></a>Simple mode</h3>
</div>
<div id="expert-mode" class="section level3">
<h3 class="hasAnchor">
<a href="#expert-mode" class="anchor"></a>Expert mode</h3>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Samuel Wieczorek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
